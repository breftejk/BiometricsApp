<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:BiometricsApp.UI.ViewModels"
        xmlns:controls="using:BiometricsApp.UI.Controls"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1600" d:DesignHeight="1000"
        x:Class="BiometricsApp.UI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Biometrics Studio - Image Processing Suite"
        Width="1600" Height="1000"
        MinWidth="1200" MinHeight="800"
        Background="#FFFFFF"
        SystemDecorations="Full"
        ExtendClientAreaToDecorationsHint="False">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Styles>
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="#0078D4"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button.primary:pointerover">
            <Setter Property="Background" Value="#106EBE"/>
        </Style>
        <Style Selector="Button.primary:pressed">
            <Setter Property="Background" Value="#005A9E"/>
        </Style>
        
        <Style Selector="Button.secondary">
            <Setter Property="Background" Value="#F3F2F1"/>
            <Setter Property="Foreground" Value="#323130"/>
            <Setter Property="BorderBrush" Value="#8A8886"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button.secondary:pointerover">
            <Setter Property="Background" Value="#E1DFDD"/>
        </Style>
        
        <Style Selector="Button.success">
            <Setter Property="Background" Value="#107C10"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button.success:pointerover">
            <Setter Property="Background" Value="#0E6B0E"/>
        </Style>
        
        <Style Selector="Button.danger">
            <Setter Property="Background" Value="#D13438"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        
        <Style Selector="TextBlock.title">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#323130"/>
        </Style>
        
        <Style Selector="TextBlock.subtitle">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#323130"/>
        </Style>
        
        <Style Selector="TextBlock.label">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="#605E5C"/>
        </Style>
        
        <Style Selector="TextBlock.caption">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#8A8886"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="Auto,Auto,*,Auto">
        
        <!-- Application Header -->
        <Border Grid.Row="0" Background="#0078D4" Padding="20,16">
            <Grid ColumnDefinitions="Auto,*">
                <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                    <Viewbox Width="32" Height="32">
                        <Canvas Width="24" Height="24">
                            <Path Fill="White" Data="M12,2L2,7V17C2,21.4 5.6,25 12,25C18.4,25 22,21.4 22,17V7L12,2M12,4.4L19,8.3V17C19,19.8 16.8,22 12,22C7.2,22 5,19.8 5,17V8.3L12,4.4M12,11A2,2 0 0,1 14,13A2,2 0 0,1 12,15A2,2 0 0,1 10,13A2,2 0 0,1 12,11Z"/>
                        </Canvas>
                    </Viewbox>
                    <StackPanel Spacing="2">
                        <TextBlock Text="Biometrics Studio" 
                                  FontSize="18" 
                                  FontWeight="SemiBold" 
                                  Foreground="White"/>
                        <TextBlock Text="Image Processing Suite" 
                                  FontSize="11" 
                                  Foreground="#FFFFFF99"
                                  Opacity="0.8"/>
                    </StackPanel>
                </StackPanel>
                
                <Border Grid.Column="1"
                        Background="#00000020" 
                        CornerRadius="12" 
                        Padding="10,6"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        IsVisible="{Binding IsProcessing}">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <ProgressBar IsIndeterminate="True"
                                    Width="100"
                                    Height="3"
                                    VerticalAlignment="Center"
                                    Foreground="White"/>
                        <TextBlock Text="Processing..." 
                                  FontSize="12" 
                                  Foreground="White"
                                  VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Ribbon Toolbar -->
        <Border Grid.Row="1" Background="#F3F2F1" BorderBrush="#EDEBE9" BorderThickness="0,0,0,1">
            <Grid Margin="20,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="16"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <!-- File Group -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="FILE" Classes="caption" Margin="0,0,0,6"/>
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <Button Command="{Binding LoadImageCommand}" Classes="success">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Viewbox Width="16" Height="16">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="White" Data="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M12,19L8,15H10.5V12H13.5V15H16L12,19Z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Text="Open" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <Button Command="{Binding SaveImageCommand}"
                                Classes="primary"
                                IsEnabled="{Binding ProcessedImage, Converter={x:Static ObjectConverters.IsNotNull}}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Viewbox Width="16" Height="16">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="White" Data="M15,9H5V5H15M12,19A3,3 0 0,1 9,16A3,3 0 0,1 12,13A3,3 0 0,1 15,16A3,3 0 0,1 12,19M17,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V7L17,3Z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Text="Save" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
                
                <Separator Grid.Column="1" Width="1" Background="#EDEBE9"/>
                
                <!-- Edit Group -->
                <StackPanel Grid.Column="2">
                    <TextBlock Text="EDIT" Classes="caption" Margin="0,0,0,6"/>
                    <StackPanel Orientation="Horizontal" Spacing="6">
                        <Button Command="{Binding UndoCommand}"
                                Classes="secondary">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Viewbox Width="16" Height="16">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="#323130" Data="M12.5,8C9.85,8 7.45,9 5.6,10.6L2,7V16H11L7.38,12.38C8.77,11.22 10.54,10.5 12.5,10.5C16.04,10.5 19.05,12.81 20.1,16L22.47,15.22C21.08,11.03 17.15,8 12.5,8Z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Text="Undo" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                        
                        <Button Command="{Binding ResetImageCommand}"
                                Classes="secondary"
                                IsEnabled="{Binding ProcessedImage, Converter={x:Static ObjectConverters.IsNotNull}}">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <Viewbox Width="16" Height="16">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="#323130" Data="M12,4C14.1,4 16.1,4.8 17.6,6.3C20.7,9.4 20.7,14.5 17.6,17.6C15.8,19.5 13.3,20.2 10.9,19.9L11.4,17.9C13.1,18.1 14.9,17.5 16.2,16.2C18.5,13.9 18.5,10.1 16.2,7.7C15.1,6.6 13.5,6 12,6V10.6L7,5.6L12,0.6V4M6.3,17.6C3.7,15 3.3,11 5.1,7.9L6.6,9.4C5.5,11.6 5.9,14.4 7.8,16.2C8.3,16.7 8.9,17.1 9.6,17.4L9,19.4C8,19 7.1,18.4 6.3,17.6Z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Text="Reset" VerticalAlignment="Center"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </StackPanel>
                
                <Separator Grid.Column="3" Width="1" Background="#EDEBE9"/>
                
                <!-- Process Group -->
                <StackPanel Grid.Column="4">
                    <TextBlock Text="PROCESS" Classes="caption" Margin="0,0,0,6"/>
                    <Button Command="{Binding ApplyOperationCommand}"
                            Classes="primary"
                            IsEnabled="{Binding OriginalImage, Converter={x:Static ObjectConverters.IsNotNull}}">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Viewbox Width="16" Height="16">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="White" Data="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M12,4A8,8 0 0,1 20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4M11,6V12L15.5,14.5L16.5,12.9L13,11V6H11Z"/>
                                </Canvas>
                            </Viewbox>
                            <TextBlock Text="Apply Operation" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
                
                <!-- Status -->
                <TextBlock Grid.Column="6" 
                          Text="{Binding StatusText}"
                          Classes="label"
                          VerticalAlignment="Center"
                          Margin="20,0,0,0"/>
            </Grid>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Row="2" ColumnDefinitions="*,Auto,380" Margin="20">
            
            <!-- Center - Images -->
            <Grid Grid.Column="0" RowDefinitions="*,16,*">
                
                <!-- Original Image -->
                <Border Grid.Row="0" 
                        Background="White" 
                        BorderBrush="#EDEBE9" 
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="16">
                    <controls:ImageWithHistogram 
                        Title="Original Image"
                        ImageSource="{Binding OriginalImage}"
                        HistogramRed="{Binding HistogramRedOriginal}"
                        HistogramGreen="{Binding HistogramGreenOriginal}"
                        HistogramBlue="{Binding HistogramBlueOriginal}"
                        HistogramAverage="{Binding HistogramAverageOriginal}"/>
                </Border>

                <!-- Processed Image (Interactive for Drawing) -->
                <Border Grid.Row="2" 
                        Background="White" 
                        BorderBrush="#EDEBE9" 
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="16"
                        IsVisible="{Binding ProcessedImage, Converter={x:Static ObjectConverters.IsNotNull}}">
                    <controls:ImageWithHistogram 
                        x:Name="ProcessedImageControl"
                        Title="Processed Image (Interactive)"
                        ImageSource="{Binding ProcessedImage}"
                        HistogramRed="{Binding HistogramRedProcessed}"
                        HistogramGreen="{Binding HistogramGreenProcessed}"
                        HistogramBlue="{Binding HistogramBlueProcessed}"
                        HistogramAverage="{Binding HistogramAverageProcessed}"
                        IsInteractive="{Binding IsDrawingModeActive}"
                        BrushSize="{Binding PencilSize}"/>
                </Border>
                
                <!-- Original Image becomes interactive when no processed image -->
                <Border Grid.Row="2" 
                        Background="White" 
                        BorderBrush="#EDEBE9" 
                        BorderThickness="1"
                        CornerRadius="4"
                        Padding="16"
                        IsVisible="{Binding ProcessedImage, Converter={x:Static ObjectConverters.IsNull}}">
                    <controls:ImageWithHistogram 
                        x:Name="OriginalImageInteractive"
                        Title="Draw Here (Interactive)"
                        ImageSource="{Binding OriginalImage}"
                        HistogramRed="{Binding HistogramRedOriginal}"
                        HistogramGreen="{Binding HistogramGreenOriginal}"
                        HistogramBlue="{Binding HistogramBlueOriginal}"
                        HistogramAverage="{Binding HistogramAverageOriginal}"
                        IsInteractive="{Binding IsDrawingModeActive}"
                        BrushSize="{Binding PencilSize}"
                        IsVisible="{Binding OriginalImage, Converter={x:Static ObjectConverters.IsNotNull}}"/>
                </Border>
                
                <!-- Placeholder when no image at all -->
                <Border Grid.Row="2" 
                        Background="#FAFAFA" 
                        BorderBrush="#EDEBE9" 
                        BorderThickness="2"
                        CornerRadius="4"
                        IsVisible="{Binding OriginalImage, Converter={x:Static ObjectConverters.IsNull}}">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center" Spacing="12">
                        <Viewbox Width="64" Height="64" Opacity="0.3">
                            <Canvas Width="24" Height="24">
                                <Path Fill="#8A8886" Data="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"/>
                            </Canvas>
                        </Viewbox>
                        <TextBlock Text="Load an image to start" 
                                  Classes="caption"
                                  HorizontalAlignment="Center"/>
                        <TextBlock Text="Click Open to load an image" 
                                  FontSize="11"
                                  Foreground="#C8C6C4"
                                  HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </Grid>

            <GridSplitter Grid.Column="1" 
                         Width="1" 
                         Background="#EDEBE9"
                         Margin="16,0"/>

            <!-- Right Sidebar - Operations Panel -->
            <Border Grid.Column="2" 
                    Background="White" 
                    BorderBrush="#EDEBE9" 
                    BorderThickness="1"
                    CornerRadius="4">
                <Grid RowDefinitions="Auto,*">
                    <!-- Header -->
                    <Border Grid.Row="0" 
                            Background="#F3F2F1" 
                            BorderBrush="#EDEBE9"
                            BorderThickness="0,0,0,1"
                            Padding="20,16">
                        <TextBlock Text="Operations" Classes="subtitle"/>
                    </Border>

                    <!-- Content -->
                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <StackPanel Spacing="12" Margin="16">
                            
                            <!-- Grouped Operation Selection with Expanders -->
                            <TextBlock Text="Select Operation" Classes="label" Margin="4,0,0,4"/>
                            
                            <!-- ðŸ“Š Binarization Group -->
                            <Expander IsExpanded="True" HorizontalAlignment="Stretch">
                                <Expander.Header>
                                    <TextBlock Text="ðŸ“Š Binarization" FontWeight="SemiBold" FontSize="14"/>
                                </Expander.Header>
                                <StackPanel Spacing="4" Margin="8,8,8,4">
                                    <RadioButton GroupName="Operations" Content="Threshold" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Threshold Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Threshold Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Otsu (Auto)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Otsu Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Otsu Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Niblack" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Niblack Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Niblack Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Sauvola" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Sauvola Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Sauvola Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Phansalkar" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Phansalkar Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Phansalkar Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Kapur (Entropy)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Kapur Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Kapur Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Li-Wu" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Li-Wu Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Li-Wu Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Bernsen" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Bernsen Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Bernsen Binarization"/>
                                    <RadioButton GroupName="Operations" Content="Adaptive Gradient" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Adaptive Gradient Binarization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Adaptive Gradient Binarization"/>
                                </StackPanel>
                            </Expander>
                            
                            <!-- ðŸŽ¨ Filters Group -->
                            <Expander HorizontalAlignment="Stretch">
                                <Expander.Header>
                                    <TextBlock Text="ðŸŽ¨ Filters" FontWeight="SemiBold" FontSize="14"/>
                                </Expander.Header>
                                <StackPanel Spacing="4" Margin="8,8,8,4">
                                    <RadioButton GroupName="Operations" Content="Convolution" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Convolution Filter'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Convolution Filter"/>
                                    <RadioButton GroupName="Operations" Content="Median" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Median Filter'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Median Filter"/>
                                    <RadioButton GroupName="Operations" Content="Pixelization" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Pixelization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Pixelization"/>
                                    <RadioButton GroupName="Operations" Content="Kuwahara" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Kuwahara Filter'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Kuwahara Filter"/>
                                    <RadioButton GroupName="Operations" Content="Predator ðŸ‘¾" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Predator Filter'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Predator Filter"/>
                                </StackPanel>
                            </Expander>
                            
                            <!-- ðŸ“ˆ Histogram & Adjustments Group -->
                            <Expander HorizontalAlignment="Stretch">
                                <Expander.Header>
                                    <TextBlock Text="ðŸ“ˆ Adjustments" FontWeight="SemiBold" FontSize="14"/>
                                </Expander.Header>
                                <StackPanel Spacing="4" Margin="8,8,8,4">
                                    <RadioButton GroupName="Operations" Content="Histogram Stretching" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Histogram Stretching'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Histogram Stretching"/>
                                    <RadioButton GroupName="Operations" Content="Histogram Equalization" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Histogram Equalization'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Histogram Equalization"/>
                                    <RadioButton GroupName="Operations" Content="Brightness" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Brightness Adjustment'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Brightness Adjustment"/>
                                    <RadioButton GroupName="Operations" Content="Contrast" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Contrast Adjustment'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Contrast Adjustment"/>
                                </StackPanel>
                            </Expander>
                            
                            <!-- âœï¸ Drawing Tools Group -->
                            <Expander HorizontalAlignment="Stretch">
                                <Expander.Header>
                                    <TextBlock Text="âœï¸ Drawing Tools" FontWeight="SemiBold" FontSize="14"/>
                                </Expander.Header>
                                <StackPanel Spacing="4" Margin="8,8,8,4">
                                    <RadioButton GroupName="Operations" Content="Pencil (Freehand)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Pencil Drawing'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Pencil Drawing"/>
                                    <RadioButton GroupName="Operations" Content="Flood Fill (Bucket)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Flood Fill'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Flood Fill"/>
                                </StackPanel>
                            </Expander>
                            
                            <!-- ðŸ” Selection & Morphology Group -->
                            <Expander HorizontalAlignment="Stretch">
                                <Expander.Header>
                                    <TextBlock Text="ðŸ” Selection &amp; Morphology" FontWeight="SemiBold" FontSize="14"/>
                                </Expander.Header>
                                <StackPanel Spacing="4" Margin="8,8,8,4">
                                    <RadioButton GroupName="Operations" Content="Magic Wand" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Magic Wand Selection'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Magic Wand Selection"/>
                                    <RadioButton GroupName="Operations" Content="Dilation (Expand)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Dilation'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Dilation"/>
                                    <RadioButton GroupName="Operations" Content="Erosion (Shrink)" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Erosion'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Erosion"/>
                                    <RadioButton GroupName="Operations" Content="Watershed" 
                                                IsChecked="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Watershed Segmentation'}"
                                                Command="{Binding SelectOperationCommand}" CommandParameter="Watershed Segmentation"/>
                                </StackPanel>
                            </Expander>

                            <Separator Background="#EDEBE9" Margin="0,4,0,0"/>

                            <!-- Operation Parameters -->
                            <!-- Threshold Binarization -->
                            <StackPanel Spacing="12" 
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Threshold Binarization'}">
                                <TextBlock Text="Threshold Binarization" Classes="subtitle" FontSize="16"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Threshold" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding BinarizationThreshold}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="255" 
                                           Value="{Binding BinarizationThreshold}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Channel" Classes="label"/>
                                    <ComboBox ItemsSource="{Binding Channels}"
                                             SelectedItem="{Binding SelectedChannel}"
                                             HorizontalAlignment="Stretch"
                                             Padding="10,8"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Otsu Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Otsu Binarization'}">
                                <TextBlock Text="Otsu Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Automatic threshold selection using Otsu's method"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Channel" Classes="label"/>
                                    <ComboBox ItemsSource="{Binding Channels}"
                                             SelectedItem="{Binding SelectedChannel}"
                                             HorizontalAlignment="Stretch"
                                             Padding="10,8"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12"
                                        IsVisible="{Binding OtsuThreshold, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=128}">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Calculated Threshold:" 
                                                  FontSize="11"
                                                  Foreground="#323130"/>
                                        <TextBlock Text="{Binding OtsuThreshold}" 
                                                  FontSize="20"
                                                  FontWeight="Bold"
                                                  Foreground="#0078D4"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Niblack Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Niblack Binarization'}">
                                <TextBlock Text="Niblack Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Local adaptive binarization based on mean and standard deviation"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="K Parameter" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding NiblackK, StringFormat='{}{0:F2}'}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="-1.0" 
                                           Maximum="0.5" 
                                           Value="{Binding NiblackK}"
                                           TickFrequency="0.1"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding NiblackWindowSize}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="51" 
                                           Value="{Binding NiblackWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Sauvola Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Sauvola Binarization'}">
                                <TextBlock Text="Sauvola Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Improved Niblack method for document images"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="K Parameter" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding SauvolaK, StringFormat='{}{0:F2}'}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0.0" 
                                           Maximum="1.0" 
                                           Value="{Binding SauvolaK}"
                                           TickFrequency="0.05"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding SauvolaWindowSize}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="51" 
                                           Value="{Binding SauvolaWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Phansalkar Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Phansalkar Binarization'}">
                                <TextBlock Text="Phansalkar Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Advanced method for low contrast images"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="K Parameter" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding PhansalkarK, StringFormat='{}{0:F2}'}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0.0" 
                                           Maximum="1.0" 
                                           Value="{Binding PhansalkarK}"
                                           TickFrequency="0.05"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding PhansalkarWindowSize}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="51" 
                                           Value="{Binding PhansalkarWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Kapur Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Kapur Binarization'}">
                                <TextBlock Text="Kapur Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Entropy-based automatic threshold selection"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <Border Background="#F3F2F1" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="No parameters required. Uses maximum entropy criterion for optimal threshold."
                                              FontSize="12"
                                              Foreground="#605E5C"
                                              TextWrapping="Wrap"/>
                                </Border>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12"
                                        IsVisible="{Binding KapurThreshold, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=128}">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Calculated Threshold:" 
                                                  FontSize="11"
                                                  Foreground="#323130"/>
                                        <TextBlock Text="{Binding KapurThreshold}" 
                                                  FontSize="20"
                                                  FontWeight="Bold"
                                                  Foreground="#0078D4"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Li-Wu Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Li-Wu Binarization'}">
                                <TextBlock Text="Li-Wu Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Minimum cross entropy threshold selection"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <Border Background="#F3F2F1" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="No parameters required. Uses minimum cross entropy criterion."
                                              FontSize="12"
                                              Foreground="#605E5C"
                                              TextWrapping="Wrap"/>
                                </Border>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12"
                                        IsVisible="{Binding LiWuThreshold, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=128}">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="Calculated Threshold:" 
                                                  FontSize="11"
                                                  Foreground="#323130"/>
                                        <TextBlock Text="{Binding LiWuThreshold}" 
                                                  FontSize="20"
                                                  FontWeight="Bold"
                                                  Foreground="#0078D4"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Bernsen Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Bernsen Binarization'}">
                                <TextBlock Text="Bernsen Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Local contrast-based binarization"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding BernsenWindowSize}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="101" 
                                           Value="{Binding BernsenWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Contrast Threshold" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding BernsenContrastThreshold}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="100" 
                                           Value="{Binding BernsenContrastThreshold}"
                                           TickFrequency="5"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Adaptive Gradient Binarization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Adaptive Gradient Binarization'}">
                                <TextBlock Text="Adaptive Gradient Binarization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Custom algorithm combining gradient information with adaptive thresholding"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding AdaptiveGradientWindowSize}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="51" 
                                           Value="{Binding AdaptiveGradientWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Gradient Weight" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding AdaptiveGradientWeight, StringFormat='{}{0:F2}'}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0.0" 
                                           Maximum="1.0" 
                                           Value="{Binding AdaptiveGradientWeight}"
                                           TickFrequency="0.05"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="âœ¨ Custom Algorithm" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                        <TextBlock Text="This algorithm uses Sobel edge detection combined with adaptive local thresholding to preserve edges better."
                                                  FontSize="11"
                                                  Foreground="#323130"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Convolution Filter -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Convolution Filter'}">
                                <TextBlock Text="Convolution Filter" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Linear filters based on convolution operation"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <TextBlock Text="Kernel Type" Classes="label"/>
                                    <ComboBox ItemsSource="{Binding ConvolutionKernels}"
                                             SelectedItem="{Binding SelectedConvolutionKernel}"
                                             HorizontalAlignment="Stretch"
                                             Padding="12,10"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸ“‹ Kernel Info" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                        <TextBlock Text="Choose from various convolution kernels: Gaussian blur for smoothing, Prewitt/Sobel for edge detection, Laplacian for feature enhancement, and more."
                                                  FontSize="11"
                                                  Foreground="#323130"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Median Filter -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Median Filter'}">
                                <TextBlock Text="Median Filter" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Non-linear filter for noise reduction with edge preservation"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding MedianFilterSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="21" 
                                           Value="{Binding MedianFilterSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                    <TextBlock Text="ðŸ’¡ Larger windows remove more noise but may blur edges"
                                              Classes="caption"
                                              TextWrapping="Wrap"
                                              Margin="0,4,0,0"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Pixelization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Pixelization'}">
                                <TextBlock Text="Pixelization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Create a mosaic/pixelated effect"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Pixel Block Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding PixelizationSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="2" 
                                           Maximum="50" 
                                           Value="{Binding PixelizationSize}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                    <Grid ColumnDefinitions="*,*,*">
                                        <TextBlock Grid.Column="0" Text="Fine" Classes="caption" HorizontalAlignment="Left"/>
                                        <TextBlock Grid.Column="1" Text="10" Classes="caption" HorizontalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" Text="Blocky" Classes="caption" HorizontalAlignment="Right"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>

                            <!-- Kuwahara Filter -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Kuwahara Filter'}">
                                <TextBlock Text="Kuwahara Filter" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Edge-preserving smoothing filter (painting-like effect)"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Window Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding KuwaharaWindowSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="15" 
                                           Value="{Binding KuwaharaWindowSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸŽ¨ Artistic Effect" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                        <TextBlock Text="Smooths regions while preserving edges, creating a painting-like effect. Great for artistic processing."
                                                  FontSize="11"
                                                  Foreground="#323130"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Predator Filter -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Predator Filter'}">
                                <TextBlock Text="Predator Filter ðŸ‘¾" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Thermal/Predator vision effect (Pixelization + MinRGB + Sobel)"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Pixel Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding PredatorPixelSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="2" 
                                           Maximum="30" 
                                           Value="{Binding PredatorPixelSize}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <CheckBox IsChecked="{Binding PredatorColorGrade}"
                                             Content="Apply Thermal Color Grading"
                                             FontSize="14"
                                             FontWeight="SemiBold"/>
                                    <TextBlock Text="Adds heat-map colors (blue â†’ green â†’ yellow â†’ red)"
                                              Classes="caption"
                                              Margin="28,0,0,0"/>
                                </StackPanel>

                                <Border Background="#1E1E1E" 
                                        BorderBrush="#00FF00"
                                        BorderThickness="2"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸ‘¾ BONUS ALGORITHM" 
                                                  FontSize="11"
                                                  FontWeight="Bold"
                                                  Foreground="#00FF00"/>
                                        <TextBlock Text="Combines: Pixelization â†’ MinRGB â†’ Sobel Edge Detection"
                                                  FontSize="11"
                                                  Foreground="#CCCCCC"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Histogram Stretching -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Histogram Stretching'}">
                                <TextBlock Text="Histogram Stretching" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Stretch histogram to specified range"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Minimum Output" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding StretchMin}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="255" 
                                           Value="{Binding StretchMin}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Maximum Output" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding StretchMax}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="255" 
                                           Value="{Binding StretchMax}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Histogram Equalization -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Histogram Equalization'}">
                                <TextBlock Text="Histogram Equalization" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Equalize histogram to improve contrast"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                <Border Background="#F3F2F1" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="No parameters required. This operation will automatically distribute pixel intensities across the full range."
                                              FontSize="12"
                                              Foreground="#605E5C"
                                              TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>

                            <!-- Brightness Adjustment -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Brightness Adjustment'}">
                                <TextBlock Text="Brightness Adjustment" Classes="subtitle" FontSize="16"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Brightness" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding BrightnessValue}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="-255" 
                                           Maximum="255" 
                                           Value="{Binding BrightnessValue}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                    <Grid ColumnDefinitions="*,*,*">
                                        <TextBlock Grid.Column="0" Text="Darker" Classes="caption" HorizontalAlignment="Left"/>
                                        <TextBlock Grid.Column="1" Text="0" Classes="caption" HorizontalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" Text="Brighter" Classes="caption" HorizontalAlignment="Right"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>

                            <!-- Contrast Adjustment -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Contrast Adjustment'}">
                                <TextBlock Text="Contrast Adjustment" Classes="subtitle" FontSize="16"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Contrast" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding ContrastValue, StringFormat='{}{0:F2}'}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="3" 
                                           Value="{Binding ContrastValue}"
                                           TickFrequency="0.1"
                                           Foreground="#0078D4"/>
                                    <Grid ColumnDefinitions="*,*,*">
                                        <TextBlock Grid.Column="0" Text="Lower" Classes="caption" HorizontalAlignment="Left"/>
                                        <TextBlock Grid.Column="1" Text="Normal (1.0)" Classes="caption" HorizontalAlignment="Center"/>
                                        <TextBlock Grid.Column="2" Text="Higher" Classes="caption" HorizontalAlignment="Right"/>
                                    </Grid>
                                </StackPanel>
                            </StackPanel>

                            <!-- Pencil Drawing -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Pencil Drawing'}">
                                <TextBlock Text="Pencil Drawing âœï¸" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Draw on the image with a pencil tool"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Pencil Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding PencilSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="1" 
                                           Maximum="50" 
                                           Value="{Binding PencilSize}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <TextBlock Text="Pencil Color" Classes="label" Margin="0,8,0,4"/>
                                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
                                    <StackPanel Grid.Column="0" Spacing="4">
                                        <TextBlock Text="R" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding PencilColorR}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding PencilColorR}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#D32F2F"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="G" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding PencilColorG}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding PencilColorG}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#388E3C"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="4">
                                        <TextBlock Text="B" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding PencilColorB}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding PencilColorB}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#1976D2"/>
                                    </StackPanel>
                                </Grid>

                                <Border Background="#107C10" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸ–±ï¸ Freehand Drawing Mode Active!" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="White"/>
                                        <TextBlock Text="Click and drag on the image below to draw freehand strokes with your mouse. Your strokes will appear immediately."
                                                  FontSize="11"
                                                  Foreground="White"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Magic Wand Selection -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Magic Wand Selection'}">
                                <TextBlock Text="Magic Wand Selection ðŸª„" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Select similar pixels with customizable tolerance range"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Tolerance Min" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding MagicWandToleranceMin}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="255" 
                                           Value="{Binding MagicWandToleranceMin}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Tolerance Max" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding MagicWandToleranceMax}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="255" 
                                           Value="{Binding MagicWandToleranceMax}"
                                           TickFrequency="1"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Max Pixels (0 = unlimited)" Classes="label"/>
                                        <TextBlock Grid.Column="1" 
                                                  Text="{Binding MagicWandMaxPixels}" 
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" 
                                           Maximum="100000" 
                                           Value="{Binding MagicWandMaxPixels}"
                                           TickFrequency="1000"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <CheckBox IsChecked="{Binding MagicWandGlobalMode}"
                                         Content="Global Flood Mode"
                                         FontSize="14"
                                         FontWeight="SemiBold"/>
                                <TextBlock Text="Select all matching pixels regardless of connectivity"
                                          Classes="caption"
                                          Margin="28,0,0,0"/>

                                <CheckBox IsChecked="{Binding MagicWandEightConnectivity}"
                                         Content="8-Connectivity"
                                         FontSize="14"
                                         FontWeight="SemiBold"/>
                                <TextBlock Text="Include diagonal neighbors in selection"
                                          Classes="caption"
                                          Margin="28,0,0,0"/>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸ’¡ How it works" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="#0078D4"/>
                                        <TextBlock Text="Uses center of image as starting point. Tolerance range defines which pixels are considered similar."
                                                  FontSize="11"
                                                  Foreground="#323130"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Flood Fill -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Flood Fill'}">
                                <TextBlock Text="Flood Fill ðŸŽ¨" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Fill similar pixels with a solid color (Paint bucket)"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <TextBlock Text="Fill Color" Classes="label" Margin="0,8,0,4"/>
                                <Grid ColumnDefinitions="*,*,*" RowDefinitions="Auto,Auto">
                                    <StackPanel Grid.Column="0" Spacing="4">
                                        <TextBlock Text="R" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding FillColorR}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding FillColorR}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#D32F2F"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" Spacing="4">
                                        <TextBlock Text="G" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding FillColorG}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding FillColorG}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#388E3C"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="2" Spacing="4">
                                        <TextBlock Text="B" Classes="caption" HorizontalAlignment="Center"/>
                                        <Slider Minimum="0" Maximum="255" Value="{Binding FillColorB}" 
                                               TickFrequency="1" IsSnapToTickEnabled="True"/>
                                        <TextBlock Text="{Binding FillColorB}" HorizontalAlignment="Center" FontWeight="SemiBold" Foreground="#1976D2"/>
                                    </StackPanel>
                                </Grid>

                                <Separator Background="#EDEBE9" Margin="0,8"/>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Tolerance Min" Classes="label"/>
                                        <TextBlock Grid.Column="1" Text="{Binding MagicWandToleranceMin}" FontWeight="SemiBold" Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" Maximum="255" Value="{Binding MagicWandToleranceMin}" TickFrequency="1" IsSnapToTickEnabled="True" Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Tolerance Max" Classes="label"/>
                                        <TextBlock Grid.Column="1" Text="{Binding MagicWandToleranceMax}" FontWeight="SemiBold" Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" Maximum="255" Value="{Binding MagicWandToleranceMax}" TickFrequency="1" IsSnapToTickEnabled="True" Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Max Pixels" Classes="label"/>
                                        <TextBlock Grid.Column="1" Text="{Binding MagicWandMaxPixels}" FontWeight="SemiBold" Foreground="#0078D4"/>
                                    </Grid>
                                    <Slider Minimum="0" Maximum="100000" Value="{Binding MagicWandMaxPixels}" TickFrequency="1000" Foreground="#0078D4"/>
                                </StackPanel>

                                <CheckBox IsChecked="{Binding MagicWandGlobalMode}" Content="Global Flood Mode" FontSize="14" FontWeight="SemiBold"/>
                                <CheckBox IsChecked="{Binding MagicWandEightConnectivity}" Content="8-Connectivity (smoother fills)" FontSize="14" FontWeight="SemiBold"/>
                                
                                <Border Background="#107C10" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="ðŸ–±ï¸ Click to Fill!" 
                                                  FontSize="11"
                                                  FontWeight="SemiBold"
                                                  Foreground="White"/>
                                        <TextBlock Text="Click anywhere on the image below to flood fill from that point. 8-connectivity gives smoother, more circular fills instead of diamond shapes."
                                                  FontSize="11"
                                                  Foreground="White"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                            <!-- Dilation -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Dilation'}">
                                <TextBlock Text="Dilation â¬†" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Expand bright regions (morphological operation)"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Kernel Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding MorphKernelSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="21" 
                                           Value="{Binding MorphKernelSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Kernel Shape" Classes="label"/>
                                    <ComboBox ItemsSource="{Binding MorphShapes}"
                                             SelectedItem="{Binding SelectedMorphShape}"
                                             HorizontalAlignment="Stretch"
                                             Padding="10,8"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="Dilation expands the selection/bright areas. Use it to grow the selected region."
                                              FontSize="11"
                                              Foreground="#323130"
                                              TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>

                            <!-- Erosion -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Erosion'}">
                                <TextBlock Text="Erosion â¬‡" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Shrink bright regions (morphological operation)"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <StackPanel Spacing="8">
                                    <Grid ColumnDefinitions="*,Auto">
                                        <TextBlock Grid.Column="0" Text="Kernel Size" Classes="label"/>
                                        <Border Grid.Column="1" 
                                                Background="#0078D4" 
                                                CornerRadius="2" 
                                                Padding="8,4"
                                                MinWidth="50">
                                            <TextBlock Text="{Binding MorphKernelSize}" 
                                                      FontWeight="Bold"
                                                      FontSize="13"
                                                      Foreground="White"
                                                      HorizontalAlignment="Center"/>
                                        </Border>
                                    </Grid>
                                    <Slider Minimum="3" 
                                           Maximum="21" 
                                           Value="{Binding MorphKernelSize}"
                                           TickFrequency="2"
                                           IsSnapToTickEnabled="True"
                                           Foreground="#0078D4"/>
                                </StackPanel>

                                <StackPanel Spacing="8">
                                    <TextBlock Text="Kernel Shape" Classes="label"/>
                                    <ComboBox ItemsSource="{Binding MorphShapes}"
                                             SelectedItem="{Binding SelectedMorphShape}"
                                             HorizontalAlignment="Stretch"
                                             Padding="10,8"/>
                                </StackPanel>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="Erosion shrinks the selection/bright areas. Use it to reduce the selected region."
                                              FontSize="11"
                                              Foreground="#323130"
                                              TextWrapping="Wrap"/>
                                </Border>
                            </StackPanel>

                            <!-- Watershed Segmentation -->
                            <StackPanel Spacing="12"
                                       IsVisible="{Binding SelectedOperation, Converter={x:Static ObjectConverters.Equal}, ConverterParameter='Watershed Segmentation'}">
                                <TextBlock Text="Watershed Segmentation ðŸ’§" Classes="subtitle" FontSize="16"/>
                                <TextBlock Text="Automatic image segmentation using watershed algorithm"
                                          Classes="caption"
                                          TextWrapping="Wrap"/>
                                
                                <Border Background="#F3F2F1" 
                                        CornerRadius="3"
                                        Padding="12">
                                    <TextBlock Text="No parameters required. The algorithm automatically segments the image based on gradient boundaries."
                                              FontSize="12"
                                              Foreground="#605E5C"
                                              TextWrapping="Wrap"/>
                                </Border>

                                <Border Background="#E8F4FD" 
                                        BorderBrush="#0078D4"
                                        BorderThickness="1"
                                        CornerRadius="3"
                                        Padding="12">
                                    <StackPanel Spacing="4">
                                        <TextBlock Text="â­ BONUS FEATURE" 
                                                  FontSize="11"
                                                  FontWeight="Bold"
                                                  Foreground="#0078D4"/>
                                        <TextBlock Text="Watershed segmentation divides the image into distinct regions by treating pixel intensities as a topographic map and 'flooding' from local minima."
                                                  FontSize="11"
                                                  Foreground="#323130"
                                                  TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>
                            </StackPanel>

                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer Status Bar -->
        <Border Grid.Row="3" 
                Background="#F3F2F1" 
                BorderBrush="#EDEBE9" 
                BorderThickness="0,1,0,0"
                Padding="20,10">
            <Grid ColumnDefinitions="Auto,*,Auto">
                <TextBlock Grid.Column="0" 
                          Text="Biometrics Studio" 
                          Classes="caption"
                          VerticalAlignment="Center"/>
                
                <TextBlock Grid.Column="2" 
                          Text="{Binding StatusText}"
                          Classes="caption"
                          VerticalAlignment="Center"/>
            </Grid>
        </Border>
    </Grid>

</Window>
